"use strict";(()=>{var X=Object.create;var V=Object.defineProperty;var Z=Object.getOwnPropertyDescriptor;var ee=Object.getOwnPropertyNames;var te=Object.getPrototypeOf,oe=Object.prototype.hasOwnProperty;var R=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+n+'" is not supported')});var $=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var ne=(n,e,t,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ee(e))!oe.call(n,i)&&i!==t&&V(n,i,{get:()=>e[i],enumerable:!(o=Z(e,i))||o.enumerable});return n};var ae=(n,e,t)=>(t=n!=null?X(te(n)):{},ne(e||!n||!n.__esModule?V(t,"default",{value:n,enumerable:!0}):t,n));var O=$(()=>{});var F=$((De,U)=>{"use strict";function k(n){if(typeof n!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(n))}function j(n,e){for(var t="",o=0,i=-1,r=0,a,s=0;s<=n.length;++s){if(s<n.length)a=n.charCodeAt(s);else{if(a===47)break;a=47}if(a===47){if(!(i===s-1||r===1))if(i!==s-1&&r===2){if(t.length<2||o!==2||t.charCodeAt(t.length-1)!==46||t.charCodeAt(t.length-2)!==46){if(t.length>2){var d=t.lastIndexOf("/");if(d!==t.length-1){d===-1?(t="",o=0):(t=t.slice(0,d),o=t.length-1-t.lastIndexOf("/")),i=s,r=0;continue}}else if(t.length===2||t.length===1){t="",o=0,i=s,r=0;continue}}e&&(t.length>0?t+="/..":t="..",o=2)}else t.length>0?t+="/"+n.slice(i+1,s):t=n.slice(i+1,s),o=s-i-1;i=s,r=0}else a===46&&r!==-1?++r:r=-1}return t}function ie(n,e){var t=e.dir||e.root,o=e.base||(e.name||"")+(e.ext||"");return t?t===e.root?t+o:t+n+o:o}var q={resolve:function(){for(var e="",t=!1,o,i=arguments.length-1;i>=-1&&!t;i--){var r;i>=0?r=arguments[i]:(o===void 0&&(o=process.cwd()),r=o),k(r),r.length!==0&&(e=r+"/"+e,t=r.charCodeAt(0)===47)}return e=j(e,!t),t?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(k(e),e.length===0)return".";var t=e.charCodeAt(0)===47,o=e.charCodeAt(e.length-1)===47;return e=j(e,!t),e.length===0&&!t&&(e="."),e.length>0&&o&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return k(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,t=0;t<arguments.length;++t){var o=arguments[t];k(o),o.length>0&&(e===void 0?e=o:e+="/"+o)}return e===void 0?".":q.normalize(e)},relative:function(e,t){if(k(e),k(t),e===t||(e=q.resolve(e),t=q.resolve(t),e===t))return"";for(var o=1;o<e.length&&e.charCodeAt(o)===47;++o);for(var i=e.length,r=i-o,a=1;a<t.length&&t.charCodeAt(a)===47;++a);for(var s=t.length,d=s-a,v=r<d?r:d,y=-1,g=0;g<=v;++g){if(g===v){if(d>v){if(t.charCodeAt(a+g)===47)return t.slice(a+g+1);if(g===0)return t.slice(a+g)}else r>v&&(e.charCodeAt(o+g)===47?y=g:g===0&&(y=0));break}var _=e.charCodeAt(o+g),b=t.charCodeAt(a+g);if(_!==b)break;_===47&&(y=g)}var w="";for(g=o+y+1;g<=i;++g)(g===i||e.charCodeAt(g)===47)&&(w.length===0?w+="..":w+="/..");return w.length>0?w+t.slice(a+y):(a+=y,t.charCodeAt(a)===47&&++a,t.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(k(e),e.length===0)return".";for(var t=e.charCodeAt(0),o=t===47,i=-1,r=!0,a=e.length-1;a>=1;--a)if(t=e.charCodeAt(a),t===47){if(!r){i=a;break}}else r=!1;return i===-1?o?"/":".":o&&i===1?"//":e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');k(e);var o=0,i=-1,r=!0,a;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,d=-1;for(a=e.length-1;a>=0;--a){var v=e.charCodeAt(a);if(v===47){if(!r){o=a+1;break}}else d===-1&&(r=!1,d=a+1),s>=0&&(v===t.charCodeAt(s)?--s===-1&&(i=a):(s=-1,i=d))}return o===i?i=d:i===-1&&(i=e.length),e.slice(o,i)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!r){o=a+1;break}}else i===-1&&(r=!1,i=a+1);return i===-1?"":e.slice(o,i)}},extname:function(e){k(e);for(var t=-1,o=0,i=-1,r=!0,a=0,s=e.length-1;s>=0;--s){var d=e.charCodeAt(s);if(d===47){if(!r){o=s+1;break}continue}i===-1&&(r=!1,i=s+1),d===46?t===-1?t=s:a!==1&&(a=1):t!==-1&&(a=-1)}return t===-1||i===-1||a===0||a===1&&t===i-1&&t===o+1?"":e.slice(t,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return ie("/",e)},parse:function(e){k(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return t;var o=e.charCodeAt(0),i=o===47,r;i?(t.root="/",r=1):r=0;for(var a=-1,s=0,d=-1,v=!0,y=e.length-1,g=0;y>=r;--y){if(o=e.charCodeAt(y),o===47){if(!v){s=y+1;break}continue}d===-1&&(v=!1,d=y+1),o===46?a===-1?a=y:g!==1&&(g=1):a!==-1&&(g=-1)}return a===-1||d===-1||g===0||g===1&&a===d-1&&a===s+1?d!==-1&&(s===0&&i?t.base=t.name=e.slice(1,d):t.base=t.name=e.slice(s,d)):(s===0&&i?(t.name=e.slice(1,a),t.base=e.slice(1,d)):(t.name=e.slice(s,a),t.base=e.slice(s,d)),t.ext=e.slice(a,d)),s>0?t.dir=e.slice(0,s-1):i&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};q.posix=q;U.exports=q});var K=$((qe,re)=>{re.exports={name:"dotenv",version:"16.3.1",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},funding:"https://github.com/motdotla/dotenv?sponsor=1",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3",decache:"^4.6.1",sinon:"^14.0.1",standard:"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0",tap:"^16.3.0",tar:"^6.1.11",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var G=$((Le,x)=>{var B=O(),M=F(),se=R("os"),ce=R("crypto"),le=K(),P=le.version,de=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function ue(n){let e={},t=n.toString();t=t.replace(/\r\n?/mg,`
`);let o;for(;(o=de.exec(t))!=null;){let i=o[1],r=o[2]||"";r=r.trim();let a=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),a==='"'&&(r=r.replace(/\\n/g,`
`),r=r.replace(/\\r/g,"\r")),e[i]=r}return e}function ge(n){let e=W(n),t=h.configDotenv({path:e});if(!t.parsed)throw new Error(`MISSING_DATA: Cannot parse ${e} for an unknown reason`);let o=Y(n).split(","),i=o.length,r;for(let a=0;a<i;a++)try{let s=o[a].trim(),d=me(t,s);r=h.decrypt(d.ciphertext,d.key);break}catch(s){if(a+1>=i)throw s}return h.parse(r)}function fe(n){console.log(`[dotenv@${P}][INFO] ${n}`)}function _e(n){console.log(`[dotenv@${P}][WARN] ${n}`)}function z(n){console.log(`[dotenv@${P}][DEBUG] ${n}`)}function Y(n){return n&&n.DOTENV_KEY&&n.DOTENV_KEY.length>0?n.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function me(n,e){let t;try{t=new URL(e)}catch(s){throw s.code==="ERR_INVALID_URL"?new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=development"):s}let o=t.password;if(!o)throw new Error("INVALID_DOTENV_KEY: Missing key part");let i=t.searchParams.get("environment");if(!i)throw new Error("INVALID_DOTENV_KEY: Missing environment part");let r=`DOTENV_VAULT_${i.toUpperCase()}`,a=n.parsed[r];if(!a)throw new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${r} in your .env.vault file.`);return{ciphertext:a,key:o}}function W(n){let e=M.resolve(process.cwd(),".env");return n&&n.path&&n.path.length>0&&(e=n.path),e.endsWith(".vault")?e:`${e}.vault`}function pe(n){return n[0]==="~"?M.join(se.homedir(),n.slice(1)):n}function ve(n){fe("Loading env from encrypted .env.vault");let e=h._parseVault(n),t=process.env;return n&&n.processEnv!=null&&(t=n.processEnv),h.populate(t,e,n),{parsed:e}}function ye(n){let e=M.resolve(process.cwd(),".env"),t="utf8",o=!!(n&&n.debug);n&&(n.path!=null&&(e=pe(n.path)),n.encoding!=null&&(t=n.encoding));try{let i=h.parse(B.readFileSync(e,{encoding:t})),r=process.env;return n&&n.processEnv!=null&&(r=n.processEnv),h.populate(r,i,n),{parsed:i}}catch(i){return o&&z(`Failed to load ${e} ${i.message}`),{error:i}}}function he(n){let e=W(n);return Y(n).length===0?h.configDotenv(n):B.existsSync(e)?h._configVault(n):(_e(`You set DOTENV_KEY but you are missing a .env.vault file at ${e}. Did you forget to build it?`),h.configDotenv(n))}function be(n,e){let t=Buffer.from(e.slice(-64),"hex"),o=Buffer.from(n,"base64"),i=o.slice(0,12),r=o.slice(-16);o=o.slice(12,-16);try{let a=ce.createDecipheriv("aes-256-gcm",t,i);return a.setAuthTag(r),`${a.update(o)}${a.final()}`}catch(a){let s=a instanceof RangeError,d=a.message==="Invalid key length",v=a.message==="Unsupported state or unable to authenticate data";if(s||d){let y="INVALID_DOTENV_KEY: It must be 64 characters long (or more)";throw new Error(y)}else if(v){let y="DECRYPTION_FAILED: Please check your DOTENV_KEY";throw new Error(y)}else throw console.error("Error: ",a.code),console.error("Error: ",a.message),a}}function we(n,e,t={}){let o=!!(t&&t.debug),i=!!(t&&t.override);if(typeof e!="object")throw new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");for(let r of Object.keys(e))Object.prototype.hasOwnProperty.call(n,r)?(i===!0&&(n[r]=e[r]),o&&z(i===!0?`"${r}" is already defined and WAS overwritten`:`"${r}" is already defined and was NOT overwritten`)):n[r]=e[r]}var h={configDotenv:ye,_configVault:ve,_parseVault:ge,config:he,decrypt:be,parse:ue,populate:we};x.exports.configDotenv=h.configDotenv;x.exports._configVault=h._configVault;x.exports._parseVault=h._parseVault;x.exports.config=h.config;x.exports.decrypt=h.decrypt;x.exports.parse=h.parse;x.exports.populate=h.populate;x.exports=h});var Q=ae(G(),1);Q.config();var Ee=process.env.API_KEY_MAPBOX;mapboxgl.accessToken=Ee;document.querySelector("[activity-data='image']").removeAttribute("srcset");document.querySelector("[activity-data='liked']").removeAttribute("srcset");function Se(n,e){for(let t of n._guide_of_trips)for(let o of t._guide_recommendations)if(o.id===e)return o;return null}async function H(n,e,t){console.log("destination id",e),console.log("activityId",n),console.log("datastoreeeee",t),console.log("guide.id",t._guide_of_trips[0].id);let o=t._guide_of_trips.find(s=>String(s.id)===e);console.log("Target dest",o);let i=[];o&&o._guide_recommendations&&(i=o._guide_recommendations.filter(s=>s._place.place_id!==n)),console.log("Related Activities",i);let r=[];for(;r.length<5&&i.length>0;){let s=Math.floor(Math.random()*i.length),d=i.splice(s,1)[0];r.push(d)}console.log("Randomactivities",r);let a=document.querySelector("[activity-data='related-activity']");a.innerHTML="",r.forEach(s=>{let d=document.createElement("div");d.className="mini-card_component is-related-activity",d.setAttribute("related-activity-id",s.place_id);let v=s._place,y=document.createElement("div");y.className="margin-bottom margin-xsmall";let g=document.createElement("img");g.src=v.oa_place_image.url,g.className="mini-card_image",y.appendChild(g),d.appendChild(y);let _=document.createElement("div");_.className="mini-card_content";let b=document.createElement("div");b.className="margin-bottom margin-xxsmall";let w=document.createElement("div");w.className="text-weight-bold",w.innerText=v.google_name,b.appendChild(w),_.appendChild(b);let S=document.createElement("div");S.className="margin-bottom margin-xxsmall";let c=document.createElement("div");c.className="mini-card_tag-wrapper",c.innerHTML=`<img src="${v._place_category.category_icon.url}" class="mini-card_tag-icon">
                              <div class="text-size-small text-color-grey">${v._place_category.category_name}</div>`,S.appendChild(c),_.appendChild(S);let u=document.createElement("div");u.className="rating-stars_component";let m=Math.floor(s._place.google_rating);for(let l=1;l<=5;l++){let f=document.createElement("img");f.className="activity-star",f.setAttribute("activity-data",`star-${l}`),l<=m?f.src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg":f.src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg",u.appendChild(f)}_.appendChild(u),d.appendChild(_),d.addEventListener("click",function(){let l=this.getAttribute("related-activity-id"),f=Se(t,l);f?flyToAndSetActive(f.coords):console.warn(`Activity with ID ${l} not found.`)}),a.appendChild(d)})}var I=[];function T(){let e=new URLSearchParams(window.location.search).get("activity_id");Object.values(I).forEach(t=>{t.style.border="2px solid grey"}),e&&I[e]&&(I[e].style.border="2px solid purple")}async function J(n,e){let o=e._guide_of_trips.find(_=>_._guide_recommendations.some(b=>b.place_id.toString()===n.toString()))?._guide_recommendations.find(_=>_.place_id.toString()===n.toString());if(!o){console.log("Activity data is missing");return}document.querySelector("[activity-data='activity_description']").textContent=o._place._place_category.category_name||"No description available.";let i=o._place._favorite_of_user_of_place.find(_=>_.place_id===o.place_id);i?document.querySelector("[wized='activity_like_button']").setAttribute("activity-data-id",i.id):document.querySelector("[wized='activity_like_button']").removeAttribute("activity-data-id"),document.querySelector("[activity-data='image']").src=o._place.oa_place_image.url,document.querySelector("[activity-data='title']").innerText=o._place.google_name,document.querySelector("[activity-data='category_icon']").src=o._place._place_category.category_icon.url,document.querySelector("[activity-data='address']").innerText=o._place.google_address_string,document.querySelector("[activity-data='phone_number']").innerText=o._place.google_phone_number,document.querySelector("[activity-data='instagram_name']").innerText=o._place.instagram_url,document.querySelector("[activity-data='place_url']").href=o._place.google_place_url,document.querySelector("[activity-data='place_url']").innerText=o._place.place_url,document.querySelector("[activity-data='sub_title']").innerText=o.note,document.querySelector("[activity-data='activity_category']").innerText=o._place.oa_category;function r(_){return _.split("_")[0].split("  ")[0]}let a=o._place._destination_activity.mobi_destination_name,s=r(a);document.querySelector("[activity-data='related-title']").innerText="Other "+s+" activities",document.querySelector("[activity-data='activity_details_title']").innerText=o._place.oa_category+" Details",document.querySelector("[activity-data='activity_description']").innerText=o._place.google_place_description,document.querySelector("[activity-data='instagram_url']").href=o._place.instagram_url,document.querySelector("[activity-data='place_url_link']").href=o._place.place_url,document.querySelector("[activity-data='directions']").href=o._place.google_place_url,document.querySelector("[activity-data='phone_number_link']").href=`tel:${o._place.google_phone_number}`,document.querySelector("[activity-data='google_rating']").textContent=o._place.google_rating,document.querySelector("[activity-data='oh_monday']").textContent=o._place.google_monday_hours?o._place.google_monday_hours:"Not added",document.querySelector("[activity-data='oh_tuesday']").textContent=o._place.google_tuesday_hours?o._place.google_tuesday_hours:"Not added",document.querySelector("[activity-data='oh_wednesday']").textContent=o._place.google_wednesday_hours?o._place.google_wednesday_hours:"Not added",document.querySelector("[activity-data='oh_thursday']").textContent=o._place.google_thursday_hours?o._place.google_thursday_hours:"Not added",document.querySelector("[activity-data='oh_friday']").textContent=o._place.google_friday_hours?o._place.google_friday_hours:"Not added",document.querySelector("[activity-data='oh_saturday']").textContent=o._place.google_saturday_hours?o._place.google_saturday_hours:"Not added",document.querySelector("[activity-data='oh_sunday']").textContent=o._place.google_sunday_hours?o._place.google_sunday_hours:"Not added";let d=o._place._favorite_of_user_of_place.some(_=>_.place_id===o.place_id),v=document.querySelector("[activity-data='liked']");v.src=d?"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/646356c55116c668dfccf4ae_heart-filled.svg":"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643568f2cf264582be96a5ce_heart.svg",document.querySelectorAll("[wized='activity_like_button']").forEach(_=>{_.addEventListener("click",async function(){console.log("activity_like_button clicked");let b=_.getAttribute("activity-data-id");if(console.log("parent_id",b),v){let w=v.getAttribute("src");console.log("Current src: ",w);let S,c;w==="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643568f2cf264582be96a5ce_heart.svg"?(v.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/646356c55116c668dfccf4ae_heart-filled.svg"),S="add_favorite",c=o.place_id):(v.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643568f2cf264582be96a5ce_heart.svg"),S="remove_favorite",c=b,console.log(S,c)),await Wized.data.setVariable(S,c)}else console.log("likedElement is null or undefined")})});let g=Math.floor(o._place.google_rating);for(let _=1;_<=5;_++){let b=document.querySelector(`[activity-data='star-${_}']`);_<=g?(console.log(g),b.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg")):b.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg")}document.querySelector("[wized=activity_info_modal]").style.display="block"}window.onload=async()=>{document.querySelector("[wized=activity_info_modal]").style.display="none",console.log("Window loaded"),Wized.request.awaitAllPageLoad(async()=>{Wized.request.await("Load Trip Page");let n=await Wized.data.get("r.18.d"),e=new URLSearchParams(window.location.search),t=e.get("destination_id"),o=e.get("activity_id"),i=document.querySelector('[wized="destination_nav"]');console.log("dataStore:",n),n._guide_of_trips.forEach(c=>{let u=document.createElement("a");u.setAttribute("wized","destination_nav_id"),u.setAttribute("href","#"),u.setAttribute("data-destination-id",c.id),u.classList.add("mab_tabs-wrapper","w-inline-block");let m=document.createElement("p");m.setAttribute("wized","destination_nav_name"),m.setAttribute("data-destination-id",c.id),m.textContent=c.place,m.classList.add("map_tabs-link"),u.appendChild(m),i.appendChild(u),H(o,t,n),u.addEventListener("click",function(){console.log(`Clicked on destination ID: ${c.id}, Place: ${c.place}`),e.delete("activity_id"),history.replaceState({},"",`${location.pathname}?${e}`);let l=_.filter(f=>f.destinationId===c.id);S(l,s)})}),t&&(document.querySelectorAll("[data-destination-id]").forEach(c=>{c.classList.remove("is-active"),c.getAttribute("data-destination-id")===t&&(console.log("tried adding class"),c.classList.add("is-active"))}),document.querySelectorAll("[data-destination-id]").forEach(c=>{c.addEventListener("click",function(u){document.querySelectorAll("[data-destination-id]").forEach(l=>l.classList.remove("is-active")),u.currentTarget.classList.add("is-active");let m=document.querySelector("[wized='activity_info_modal']");m&&(m.style.display="none")})}));let r=document.querySelectorAll('[wized="destination_nav"]');r.forEach(c=>{console.log(r),c.getAttribute("data-destination-id")===t?c.classList.add("is-active"):c.classList.remove("is-active")}),o&&J(o,n);let a=[0,0];if(t){for(let c of n._guide_of_trips)if(c.id.toString()===t){let u=c._destination&&c._destination[0];a=[u.mobi_lng,u.mobi_lat];break}}else{let c=n._guide_of_trips[0],u=c._destination&&c._destination[0];a=[u.mobi_lng,u.mobi_lat]}let s=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:a,zoom:17}),d=null;function v(c){console.log("Fly to place",c);let m=20*16;s.flyTo({center:[c.google_lng,c.google_lat],zoom:15,offset:[m,0]});let l=document.querySelector(`[marker_activity_id="${c.place_id}"]`);l&&(l.style.border="2px solid purple",d=l)}document.querySelectorAll("[data-destination-id]").forEach(c=>{c.addEventListener("click",function(){document.querySelectorAll("[data-destination-id]").forEach(l=>{l.classList.remove("is-active")}),this.classList.add("is-active");let u=this.getAttribute("data-destination-id");console.log(`Destination ID clicked: ${u}`);let m=n._guide_of_trips.find(l=>l.id.toString()===u);if(console.log(n._guide_of_trips),console.log(u),m&&m._destination&&m._destination[0]){let f=m._guide_recommendations.map(A=>[A._place.google_lng,A._place.google_lat]);S(f,s);let p=new URLSearchParams(window.location.search);p.set("destination_id",u),p.delete("activity_id"),history.replaceState({},"",`${location.pathname}?${p}`)}})});function y(c,u){let[m,l]=c,[f,p]=u;return Math.sqrt(Math.pow(f-m,2)+Math.pow(p-l,2))}s.on("moveend",()=>{let c=s.getCenter().toArray();console.log("Map moved, center is: ",c);let u=null,m=1/0;if(n._guide_of_trips.forEach(l=>{let f=l;if(f.id){let p=[f._destination[0].mobi_lng,f._destination[0].mobi_lat];console.log(p);let A=y(c,p);console.log("Calculated distance: ",A),A<m&&(m=A,u={id:f.id,mobi_lat:f._destination[0].mobi_lat,mobi_lng:f._destination[0].mobi_lng},console.log("Updated closest destination: ",u))}}),u){console.log("Closest destination is: ",u),document.querySelectorAll("[data-destination-id]").forEach(f=>{console.log("Removing is-active class from: ",f),f.classList.remove("is-active")});let l=document.querySelector(`[data-destination-id="${u.id}"]`);l?(console.log("Adding is-active class to: ",l),l.classList.add("is-active")):console.log(`No element found for destination_id: ${u}`)}else console.log("No closest destination found")}),s.addControl(new mapboxgl.NavigationControl);function g(c,u,m){let l=c._place;if(console.log("Marker added at:",l.google_lng,l.google_lat),!l)return null;let f=l._place_category.category_icon.url,p=document.createElement("div");p.style.backgroundImage=`url("${f}")`,p.setAttribute("marker_activity_id",c.place_id),p.style.backgroundRepeat="no-repeat",p.style.backgroundPosition="center",p.style.backgroundSize="18px 18px",p.style.width="41px",p.style.height="25px",p.style.borderRadius="12.5px",p.style.backgroundColor="var(--primary-white, #FFF)",p.style.boxShadow="0px 4px 4px 0px rgba(35, 16, 94, 0.10)",p.style.border="2px solid grey";let A=new mapboxgl.Marker(p).setLngLat([l.google_lng,l.google_lat]).addTo(u),E=`
        <div class="mini-card_component .is-popup">
        <img src="${l.oa_place_image.url}" alt="" class="mini-card_image">
        <div class="mini-card_content">
        <div class="margin-bottom margin-xxsmall">
        <div class="text-weight-bold">${l.google_name}</div>
        </div>
        <div class="margin-bottom margin-xsmall">
        <div class="mini-card_tag-wrapper">
        <img src="${l._place_category.category_icon.url}" loading="lazy" alt="" class="mini-card_tag-icon">
        <div class="text-size-small text-color-grey">${l._place_category.category_name||"No description available."}</div>
        </div>
        </div>
        <div class="rating-stars_component">
        <img id="popup-star-1" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-2" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-3" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-4" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-5" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        </div>
        </div>
        <img loading="lazy" alt="" class="popup-card_arrow">
        </div>
        `,C=new mapboxgl.Popup({offset:25,closeButton:!1}).setHTML(E);return C.on("open",()=>{let D=Math.floor(l.google_rating);for(let L=1;L<=5;L++){let N=C._content.querySelector(`#popup-star-${L}`);N&&(N.src=L<=D?"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg":"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg")}}),u.on("click",()=>{document.querySelector("[wized=activity_info_modal]").style.display="none",m=null,w=null,e.delete("activity_id");let D=new URL(window.location.href);D.search=e.toString(),history.replaceState(null,null,D.toString()),T()}),p.addEventListener("mouseenter",()=>{p.style.cursor="pointer",C.setLngLat(A.getLngLat()).addTo(u)}),p.addEventListener("mouseleave",()=>{p.style.cursor="default",C.remove()}),p.addEventListener("click",D=>{D.stopPropagation(),m=c.id,w=c.place_id,e.set("activity_id",c.place_id),history.replaceState({},"",`${location.pathname}?${e}`),console.log(`Marker clicked with activity ID: ${c.place_id}`),J(c.place_id,n),T(),v(l),H(o,t,n)}),document.querySelectorAll("[wized='activity_close_button']").forEach(function(D){D.addEventListener("click",function(L){console.log("Close clicked"),document.querySelector("[wized=activity_info_modal]").style.display="none",e.delete("activity_id");let N=new URL(window.location.href);N.search=e.toString(),history.replaceState(null,null,N.toString()),T()})}),p}let _=[],b=[];var w=null;s.on("load",function(){console.log("Map loaded");let c=new URLSearchParams(window.location.search),u=c.get("destination_id"),m=c.get("activity_id"),l=!1;n._guide_of_trips.forEach(f=>{console.log(`Processing guide ID: ${f.id}`),(f._guide_recommendations||[]).forEach(A=>{let E=A._place;if(!E)return;console.log(`Adding coordinates: [${E.google_lng}, ${E.google_lat}]`),_.push([E.google_lng,E.google_lat]),f.id.toString()===u&&b.push([E.google_lng,E.google_lat]);let C=g(A,s,d);C&&(d=C,I[E.id]=C),console.log("This is place",E),String(E.id)===m&&(l=!0,v(E))})}),T(),window.addEventListener("popstate",T),console.log(`Generated ${_.length} coordinates`),console.log("Coordinates:",_),m&&!l&&console.log(`No activity found for ID: ${m}`),u&&!l?(console.log(`Setting map bounds for destination_id: ${u}`),S(b,s)):l||console.log("No destination_id or activity_id found. Using default map settings.")});function S(c,u){if(!c.length)return;let m=c.reduce((l,f)=>l.extend(f),new mapboxgl.LngLatBounds(c[0],c[0]));u.fitBounds(m,{padding:60})}})};})();
