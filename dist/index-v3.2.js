"use strict";(()=>{var z=(c=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(c,{get:(r,u)=>(typeof require<"u"?require:r)[u]}):c)(function(c){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+c+'" is not supported')});typeof window<"u"&&(window.require=function(c){switch(c){case"path":return{resolve:function(){return""}};case"os":return{};case"crypto":return{};default:throw new Error(`Dynamic require of "${c}" is not supported`)}});console.log("Shims.js is running");typeof global>"u"&&(window.global=window);typeof global.process>"u"&&(global.process={});typeof global.process.env>"u"&&(global.process.env={});global.process.cwd=global.process.cwd||(()=>"/");typeof global>"u"&&(window.global=window);global.process=global.process||{};global.process.env=global.process.env||{};global.Buffer=global.Buffer||{};var I,T,M;typeof process<"u"&&process.versions&&process.versions.node&&(I=z("path"),T=z("os"),M=z("crypto"));mapboxgl.accessToken="pk.eyJ1Ijoiam9yZGFub25hcnJpdmFsIiwiYSI6ImNsbHY4bW0zaTFxZ3czZ256bjlqODZmNncifQ.1xHX4Xvmvz9KNYmrZdFybA";document.querySelector("[activity-data='image']").removeAttribute("srcset");document.querySelector("[activity-data='liked']").removeAttribute("srcset");function D(c,r){for(let u of c._guide_of_trips)for(let t of u._guide_recommendations)if(t.id===r)return t;return null}async function N(c,r,u){console.log("destination id",r),console.log("activityId",c),console.log("datastoreeeee",u),console.log("guide.id",u._guide_of_trips[0].id);let t=u._guide_of_trips.find(d=>String(d.id)===r);console.log("Target dest",t);let v=[];t&&t._guide_recommendations&&(v=t._guide_recommendations.filter(d=>d._place.place_id!==c)),console.log("Related Activities",v);let h=[];for(;h.length<5&&v.length>0;){let d=Math.floor(Math.random()*v.length),_=v.splice(d,1)[0];h.push(_)}console.log("Randomactivities",h);let w=document.querySelector("[activity-data='related-activity']");w.innerHTML="",h.forEach(d=>{let _=document.createElement("div");_.className="mini-card_component is-related-activity",_.setAttribute("related-activity-id",d.place_id);let p=d._place,A=document.createElement("div");A.className="margin-bottom margin-xsmall";let S=document.createElement("img");S.src=p.oa_place_image.url,S.className="mini-card_image",A.appendChild(S),_.appendChild(A);let l=document.createElement("div");l.className="mini-card_content";let g=document.createElement("div");g.className="margin-bottom margin-xxsmall";let b=document.createElement("div");b.className="text-weight-bold",b.innerText=p.google_name,g.appendChild(b),l.appendChild(g);let y=document.createElement("div");y.className="margin-bottom margin-xxsmall";let e=document.createElement("div");e.className="mini-card_tag-wrapper",e.innerHTML=`<img src="${p._place_category.category_icon.url}" class="mini-card_tag-icon">
                              <div class="text-size-small text-color-grey">${p._place_category.category_name}</div>`,y.appendChild(e),l.appendChild(y);let a=document.createElement("div");a.className="rating-stars_component";let n=Math.floor(d._place.google_rating);for(let o=1;o<=5;o++){let i=document.createElement("img");i.className="activity-star",i.setAttribute("activity-data",`star-${o}`),o<=n?i.src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg":i.src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg",a.appendChild(i)}l.appendChild(a),_.appendChild(l),_.addEventListener("click",function(){let o=this.getAttribute("related-activity-id"),i=D(u,o);i?flyToAndSetActive(i.coords):console.warn(`Activity with ID ${o} not found.`)}),w.appendChild(_)})}var C=[];function L(){let r=new URLSearchParams(window.location.search).get("activity_id");Object.values(C).forEach(u=>{u.style.border="2px solid grey"}),r&&C[r]&&(C[r].style.border="2px solid purple")}async function $(c,r){let t=r._guide_of_trips.find(l=>l._guide_recommendations.some(g=>g.place_id.toString()===c.toString()))?._guide_recommendations.find(l=>l.place_id.toString()===c.toString());if(!t){console.log("Activity data is missing");return}document.querySelector("[activity-data='activity_description']").textContent=t._place._place_category.category_name||"No description available.";let v=t._place._favorite_of_user_of_place.find(l=>l.place_id===t.place_id);v?document.querySelector("[wized='activity_like_button']").setAttribute("activity-data-id",v.id):document.querySelector("[wized='activity_like_button']").removeAttribute("activity-data-id"),document.querySelector("[activity-data='image']").src=t._place.oa_place_image.url,document.querySelector("[activity-data='title']").innerText=t._place.google_name,document.querySelector("[activity-data='category_icon']").src=t._place._place_category.category_icon.url,document.querySelector("[activity-data='address']").innerText=t._place.google_address_string,document.querySelector("[activity-data='phone_number']").innerText=t._place.google_phone_number,document.querySelector("[activity-data='instagram_name']").innerText=t._place.instagram_url,document.querySelector("[activity-data='place_url']").href=t._place.google_place_url,document.querySelector("[activity-data='place_url']").innerText=t._place.place_url,document.querySelector("[activity-data='sub_title']").innerText=t.note,document.querySelector("[activity-data='activity_category']").innerText=t._place.oa_category;function h(l){return l.split("_")[0].split("  ")[0]}let w=t._place._destination_activity.mobi_destination_name,d=h(w);document.querySelector("[activity-data='related-title']").innerText="Other "+d+" activities",document.querySelector("[activity-data='activity_details_title']").innerText=t._place.oa_category+" Details",document.querySelector("[activity-data='activity_description']").innerText=t._place.google_place_description,document.querySelector("[activity-data='instagram_url']").href=t._place.instagram_url,document.querySelector("[activity-data='place_url_link']").href=t._place.place_url,document.querySelector("[activity-data='directions']").href=t._place.google_place_url,document.querySelector("[activity-data='phone_number_link']").href=`tel:${t._place.google_phone_number}`,document.querySelector("[activity-data='google_rating']").textContent=t._place.google_rating,document.querySelector("[activity-data='oh_monday']").textContent=t._place.google_monday_hours?t._place.google_monday_hours:"Not added",document.querySelector("[activity-data='oh_tuesday']").textContent=t._place.google_tuesday_hours?t._place.google_tuesday_hours:"Not added",document.querySelector("[activity-data='oh_wednesday']").textContent=t._place.google_wednesday_hours?t._place.google_wednesday_hours:"Not added",document.querySelector("[activity-data='oh_thursday']").textContent=t._place.google_thursday_hours?t._place.google_thursday_hours:"Not added",document.querySelector("[activity-data='oh_friday']").textContent=t._place.google_friday_hours?t._place.google_friday_hours:"Not added",document.querySelector("[activity-data='oh_saturday']").textContent=t._place.google_saturday_hours?t._place.google_saturday_hours:"Not added",document.querySelector("[activity-data='oh_sunday']").textContent=t._place.google_sunday_hours?t._place.google_sunday_hours:"Not added";let _=t._place._favorite_of_user_of_place.some(l=>l.place_id===t.place_id),p=document.querySelector("[activity-data='liked']");p.src=_?"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/646356c55116c668dfccf4ae_heart-filled.svg":"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643568f2cf264582be96a5ce_heart.svg",document.querySelectorAll("[wized='activity_like_button']").forEach(l=>{l.addEventListener("click",async function(){console.log("activity_like_button clicked");let g=l.getAttribute("activity-data-id");if(console.log("parent_id",g),p){let b=p.getAttribute("src");console.log("Current src: ",b);let y,e;b==="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643568f2cf264582be96a5ce_heart.svg"?(p.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/646356c55116c668dfccf4ae_heart-filled.svg"),y="add_favorite",e=t.place_id):(p.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643568f2cf264582be96a5ce_heart.svg"),y="remove_favorite",e=g,console.log(y,e)),await Wized.data.setVariable(y,e)}else console.log("likedElement is null or undefined")})});let S=Math.floor(t._place.google_rating);for(let l=1;l<=5;l++){let g=document.querySelector(`[activity-data='star-${l}']`);l<=S?(console.log(S),g.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg")):g.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg")}document.querySelector("[wized=activity_info_modal]").style.display="block"}window.onload=async()=>{document.querySelector("[wized=activity_info_modal]").style.display="none",console.log("Window loaded"),Wized.request.awaitAllPageLoad(async()=>{Wized.request.await("Load Trip Page");let c=await Wized.data.get("r.18.d"),r=new URLSearchParams(window.location.search),u=r.get("destination_id"),t=r.get("activity_id"),v=document.querySelector('[wized="destination_nav"]');console.log("dataStore:",c),c._guide_of_trips.forEach(e=>{let a=document.createElement("a");a.setAttribute("wized","destination_nav_id"),a.setAttribute("href","#"),a.setAttribute("data-destination-id",e.id),a.classList.add("mab_tabs-wrapper","w-inline-block");let n=document.createElement("p");n.setAttribute("wized","destination_nav_name"),n.setAttribute("data-destination-id",e.id),n.textContent=e.place,n.classList.add("map_tabs-link"),a.appendChild(n),v.appendChild(a),N(t,u,c),a.addEventListener("click",function(){console.log(`Clicked on destination ID: ${e.id}, Place: ${e.place}`),r.delete("activity_id"),history.replaceState({},"",`${location.pathname}?${r}`);let o=l.filter(i=>i.destinationId===e.id);y(o,d)})}),u&&(document.querySelectorAll("[data-destination-id]").forEach(e=>{e.classList.remove("is-active"),e.getAttribute("data-destination-id")===u&&(console.log("tried adding class"),e.classList.add("is-active"))}),document.querySelectorAll("[data-destination-id]").forEach(e=>{e.addEventListener("click",function(a){document.querySelectorAll("[data-destination-id]").forEach(o=>o.classList.remove("is-active")),a.currentTarget.classList.add("is-active");let n=document.querySelector("[wized='activity_info_modal']");n&&(n.style.display="none")})}));let h=document.querySelectorAll('[wized="destination_nav"]');h.forEach(e=>{console.log(h),e.getAttribute("data-destination-id")===u?e.classList.add("is-active"):e.classList.remove("is-active")}),t&&$(t,c);let w=[0,0];if(u){for(let e of c._guide_of_trips)if(e.id.toString()===u){let a=e._destination&&e._destination[0];w=[a.mobi_lng,a.mobi_lat];break}}else{let e=c._guide_of_trips[0],a=e._destination&&e._destination[0];w=[a.mobi_lng,a.mobi_lat]}let d=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:w,zoom:17}),_=null;function p(e){console.log("Fly to place",e);let n=20*16;d.flyTo({center:[e.google_lng,e.google_lat],zoom:15,offset:[n,0]});let o=document.querySelector(`[marker_activity_id="${e.place_id}"]`);o&&(o.style.border="2px solid purple",_=o)}document.querySelectorAll("[data-destination-id]").forEach(e=>{e.addEventListener("click",function(){document.querySelectorAll("[data-destination-id]").forEach(o=>{o.classList.remove("is-active")}),this.classList.add("is-active");let a=this.getAttribute("data-destination-id");console.log(`Destination ID clicked: ${a}`);let n=c._guide_of_trips.find(o=>o.id.toString()===a);if(console.log(c._guide_of_trips),console.log(a),n&&n._destination&&n._destination[0]){let i=n._guide_recommendations.map(f=>[f._place.google_lng,f._place.google_lat]);y(i,d);let s=new URLSearchParams(window.location.search);s.set("destination_id",a),s.delete("activity_id"),history.replaceState({},"",`${location.pathname}?${s}`)}})});function A(e,a){let[n,o]=e,[i,s]=a;return Math.sqrt(Math.pow(i-n,2)+Math.pow(s-o,2))}d.on("moveend",()=>{let e=d.getCenter().toArray();console.log("Map moved, center is: ",e);let a=null,n=1/0;if(c._guide_of_trips.forEach(o=>{let i=o;if(i.id){let s=[i._destination[0].mobi_lng,i._destination[0].mobi_lat];console.log(s);let f=A(e,s);console.log("Calculated distance: ",f),f<n&&(n=f,a={id:i.id,mobi_lat:i._destination[0].mobi_lat,mobi_lng:i._destination[0].mobi_lng},console.log("Updated closest destination: ",a))}}),a){console.log("Closest destination is: ",a),document.querySelectorAll("[data-destination-id]").forEach(i=>{console.log("Removing is-active class from: ",i),i.classList.remove("is-active")});let o=document.querySelector(`[data-destination-id="${a.id}"]`);o?(console.log("Adding is-active class to: ",o),o.classList.add("is-active")):console.log(`No element found for destination_id: ${a}`)}else console.log("No closest destination found")}),d.addControl(new mapboxgl.NavigationControl);function S(e,a,n){let o=e._place;if(console.log("Marker added at:",o.google_lng,o.google_lat),!o)return null;let i=o._place_category.category_icon.url,s=document.createElement("div");s.style.backgroundImage=`url("${i}")`,s.setAttribute("marker_activity_id",e.place_id),s.style.backgroundRepeat="no-repeat",s.style.backgroundPosition="center",s.style.backgroundSize="18px 18px",s.style.width="41px",s.style.height="25px",s.style.borderRadius="12.5px",s.style.backgroundColor="var(--primary-white, #FFF)",s.style.boxShadow="0px 4px 4px 0px rgba(35, 16, 94, 0.10)",s.style.border="2px solid grey";let f=new mapboxgl.Marker(s).setLngLat([o.google_lng,o.google_lat]).addTo(a),m=`
        <div class="mini-card_component .is-popup">
        <img src="${o.oa_place_image.url}" alt="" class="mini-card_image">
        <div class="mini-card_content">
        <div class="margin-bottom margin-xxsmall">
        <div class="text-weight-bold">${o.google_name}</div>
        </div>
        <div class="margin-bottom margin-xsmall">
        <div class="mini-card_tag-wrapper">
        <img src="${o._place_category.category_icon.url}" loading="lazy" alt="" class="mini-card_tag-icon">
        <div class="text-size-small text-color-grey">${o._place_category.category_name||"No description available."}</div>
        </div>
        </div>
        <div class="rating-stars_component">
        <img id="popup-star-1" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-2" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-3" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-4" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-5" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        </div>
        </div>
        <img loading="lazy" alt="" class="popup-card_arrow">
        </div>
        `,x=new mapboxgl.Popup({offset:25,closeButton:!1}).setHTML(m);return x.on("open",()=>{let q=Math.floor(o.google_rating);for(let k=1;k<=5;k++){let E=x._content.querySelector(`#popup-star-${k}`);E&&(E.src=k<=q?"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg":"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg")}}),a.on("click",()=>{document.querySelector("[wized=activity_info_modal]").style.display="none",n=null,b=null,r.delete("activity_id");let q=new URL(window.location.href);q.search=r.toString(),history.replaceState(null,null,q.toString()),L()}),s.addEventListener("mouseenter",()=>{s.style.cursor="pointer",x.setLngLat(f.getLngLat()).addTo(a)}),s.addEventListener("mouseleave",()=>{s.style.cursor="default",x.remove()}),s.addEventListener("click",q=>{q.stopPropagation(),n=e.id,b=e.place_id,r.set("activity_id",e.place_id),history.replaceState({},"",`${location.pathname}?${r}`),console.log(`Marker clicked with activity ID: ${e.place_id}`),$(e.place_id,c),L(),p(o),N(t,u,c)}),document.querySelectorAll("[wized='activity_close_button']").forEach(function(q){q.addEventListener("click",function(k){console.log("Close clicked"),document.querySelector("[wized=activity_info_modal]").style.display="none",r.delete("activity_id");let E=new URL(window.location.href);E.search=r.toString(),history.replaceState(null,null,E.toString()),L()})}),s}let l=[],g=[];var b=null;d.on("load",function(){console.log("Map loaded");let e=new URLSearchParams(window.location.search),a=e.get("destination_id"),n=e.get("activity_id"),o=!1;c._guide_of_trips.forEach(i=>{console.log(`Processing guide ID: ${i.id}`),(i._guide_recommendations||[]).forEach(f=>{let m=f._place;if(!m)return;console.log(`Adding coordinates: [${m.google_lng}, ${m.google_lat}]`),l.push([m.google_lng,m.google_lat]),i.id.toString()===a&&g.push([m.google_lng,m.google_lat]);let x=S(f,d,_);x&&(_=x,C[m.id]=x),console.log("This is place",m),String(m.id)===n&&(o=!0,p(m))})}),L(),window.addEventListener("popstate",L),console.log(`Generated ${l.length} coordinates`),console.log("Coordinates:",l),n&&!o&&console.log(`No activity found for ID: ${n}`),a&&!o?(console.log(`Setting map bounds for destination_id: ${a}`),y(g,d)):o||console.log("No destination_id or activity_id found. Using default map settings.")});function y(e,a){if(!e.length)return;let n=e.reduce((o,i)=>o.extend(i),new mapboxgl.LngLatBounds(e[0],e[0]));a.fitBounds(n,{padding:60})}})};})();
