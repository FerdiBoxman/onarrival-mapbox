"use strict";(()=>{var T=(c=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(c,{get:(u,i)=>(typeof require<"u"?require:u)[i]}):c)(function(c){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+c+'" is not supported')});typeof window<"u"&&(window.require=function(c){switch(c){case"path":return{resolve:function(){return""}};case"os":return{};case"crypto":return{};default:throw new Error(`Dynamic require of "${c}" is not supported`)}});console.log("Shims.js is running");typeof global>"u"&&(window.global=window);typeof global.process>"u"&&(global.process={});typeof global.process.env>"u"&&(global.process.env={});global.process.cwd=global.process.cwd||(()=>"/");typeof global>"u"&&(window.global=window);global.process=global.process||{};global.process.env=global.process.env||{};global.Buffer=global.Buffer||{};var O,B,J;typeof process<"u"&&process.versions&&process.versions.node&&(O=T("path"),B=T("os"),J=T("crypto"));document.querySelector("[activity-data='image']").removeAttribute("srcset");document.querySelector("[activity-data='liked']").removeAttribute("srcset");function P(c,u){console.log(u);for(let i of u._guide_of_trips)for(let _ of i._guide_recommendations){let S=_._place;if(S&&S.id===c)return i.id}return null}var z=!1,W={};console.log("Initial favoritesState:",JSON.stringify(W));var H={};console.log("Initial isManuallyChanged:",JSON.stringify(H));async function U(c,u,i){console.log("destination id --------",u),console.log("activityId",c),console.log("datastoreeeee",i),console.log("guide id",i._guide_of_trips);let _=i._guide_of_trips.find(b=>String(b.id)===String(u));console.log("Target dest",_);let S=[];_&&_._guide_recommendations&&(S=_._guide_recommendations.filter(b=>String(b.place_id)!==String(c))),console.log("Target dest",_),console.log("Related Activities",S);let o=document.querySelector("[activity-data='related-activity']");o.innerHTML="",S.forEach(b=>{let k=document.createElement("div");k.className="mini-card_component is-related-activity",k.setAttribute("related-activity-id",b.place_id);let q=b._place,y=document.createElement("div");y.className="margin-bottom margin-xsmall";let f=document.createElement("img");f.src=q.oa_place_image.url,f.className="mini-card_image",y.appendChild(f),k.appendChild(y);let v=document.createElement("div");v.className="mini-card_content";let C=document.createElement("div");C.className="margin-bottom margin-xxsmall";let E=document.createElement("div");E.className="text-weight-bold",E.innerText=q.google_name,C.appendChild(E),v.appendChild(C);let $=document.createElement("div");$.className="margin-bottom margin-xxsmall";let r=document.createElement("div");r.className="mini-card_tag-wrapper",r.innerHTML=`<img src="${q._place_category.category_icon.url}" class="mini-card_tag-icon">
                              <div class="text-size-small text-color-grey">${q._place_category.category_name}</div>`,$.appendChild(r),v.appendChild($);let d=document.createElement("div");d.className="rating-stars_component";let g=Math.floor(b._place.google_rating);for(let h=1;h<=5;h++){let e=document.createElement("img");e.className="activity-star",e.setAttribute("activity-data",`star-${h}`),h<=g?e.src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg":e.src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg",d.appendChild(e)}v.appendChild(d),k.appendChild(v),o.appendChild(k)})}var N=[];function L(){let u=new URLSearchParams(window.location.search).get("activity_id");if(Object.values(N).forEach(i=>{i.style.border="2px solid grey",i.style.zIndex="0";let _=i.getAttribute("original-image-url")||"default_image_url_here";i.style.backgroundImage=`url("${_}")`}),u&&N[u]){N[u].style.border="2px solid #636BFF",N[u].style.zIndex="1";let i=N[u].getAttribute("active-image-url")||"active_image_url_here";N[u].style.backgroundImage=`url("${i}")`}}async function F(c,u,i,_){let o=u._guide_of_trips.find(r=>r._guide_recommendations.some(d=>d.place_id.toString()===c.toString()))?._guide_recommendations.find(r=>r.place_id.toString()===c.toString());if(!o){console.log("Activity data is missing");return}document.querySelector("[activity-data='activity_description']").textContent=o._place._place_category.category_name||"No description available.";let b=o._place._favorite_of_user_of_place.find(r=>r.place_id===o.place_id);document.querySelector("[wized='activity_like_button']").setAttribute("activity-data-place-id",o.place_id),b?document.querySelector("[wized='activity_like_button']").setAttribute("activity-data-id",b.id):document.querySelector("[wized='activity_like_button']").removeAttribute("activity-data-id"),document.querySelector("[activity-data='image']").src=o._place.oa_place_image.url,document.querySelector("[activity-data='title']").innerText=o._place.google_name,document.querySelector("[activity-data='category_icon']").src=o._place._place_category.category_icon_black.url,document.querySelector("[activity-data='address']").innerText=o._place.google_address_string,document.querySelector("[activity-data='phone_number']").innerText=o._place.google_phone_number,document.querySelector("[activity-data='instagram_name']").innerText=o._place.instagram_url,document.querySelector("[activity-data='place_url']").href=o._place.google_place_url,document.querySelector("[activity-data='place_url']").innerText=o._place.place_url,document.querySelector("[activity-data='sub_title']").innerText=o.note,document.querySelector("[activity-data='activity_category']").innerText=o._place.oa_category;function k(r){return r.split("_")[0].split("  ")[0]}let q=o._place._destination_activity.mobi_destination_name,y=k(q);document.querySelector("[activity-data='related-title']").innerText="Other "+y+" activities",document.querySelector("[activity-data='activity_details_title']").innerText=o._place.oa_category+" Details",document.querySelector("[activity-data='activity_description']").innerText=o._place.google_place_description,document.querySelector("[activity-data='instagram_url']").href=o._place.instagram_url,document.querySelector("[activity-data='place_url_link']").href=o._place.place_url,document.querySelector("[activity-data='directions']").href=o._place.google_place_url,document.querySelector("[activity-data='phone_number_link']").href=`tel:${o._place.google_phone_number}`,document.querySelector("[activity-data='google_rating']").textContent=o._place.google_rating,document.querySelector("[activity-data='oh_monday']").textContent=o._place.google_monday_hours?o._place.google_monday_hours:"Not added",document.querySelector("[activity-data='oh_tuesday']").textContent=o._place.google_tuesday_hours?o._place.google_tuesday_hours:"Not added",document.querySelector("[activity-data='oh_wednesday']").textContent=o._place.google_wednesday_hours?o._place.google_wednesday_hours:"Not added",document.querySelector("[activity-data='oh_thursday']").textContent=o._place.google_thursday_hours?o._place.google_thursday_hours:"Not added",document.querySelector("[activity-data='oh_friday']").textContent=o._place.google_friday_hours?o._place.google_friday_hours:"Not added",document.querySelector("[activity-data='oh_saturday']").textContent=o._place.google_saturday_hours?o._place.google_saturday_hours:"Not added",document.querySelector("[activity-data='oh_sunday']").textContent=o._place.google_sunday_hours?o._place.google_sunday_hours:"Not added";let f=JSON.parse(localStorage.getItem("favoritesState"))||{},v=JSON.parse(localStorage.getItem("isManuallyChanged"))||{};console.log("Initial favoritesState:",JSON.stringify(f)),console.log("Initial isManuallyChanged:",JSON.stringify(v));function C(){document.querySelectorAll('[wized="activity_like_button"]').forEach(d=>{let g=d.cloneNode(!0);d.parentNode.replaceChild(g,d)}),document.querySelectorAll('[wized="activity_like_button"]').forEach(d=>{let g=d.getAttribute("activity-data-place-id");console.log(`Processing element with parentPlaceId: ${g}`),v[g]?console.log(`State manually changed for parentPlaceId: ${g}`):(console.log(`State not manually changed for parentPlaceId: ${g}`),f[g]=d.getAttribute("activity-liked")==="true"),E(d,f[g]),d.addEventListener("click",function(){console.log(`activity_like_button clicked for parentPlaceId: ${g}`),console.log(`Current favorite state before toggle: ${f[g]}`);let h=!f[g];console.log(`New favorite state after toggle: ${h}`),f[g]=h,v[g]=!0,localStorage.setItem("favoritesState",JSON.stringify(f)),localStorage.setItem("isManuallyChanged",JSON.stringify(v)),E(d,h),console.log(`Updated favoritesState and isManuallyChanged for parentPlaceId ${g}`)})})}function E(r,d){let g=r.querySelector(".floating-round-button_icon");d?g.src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/646356c55116c668dfccf4ae_heart-filled.svg":g.src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643568f2cf264582be96a5ce_heart.svg",console.log(`Updating UI icon for favorite: ${d}`)}C();let $=Math.floor(o._place.google_rating);for(let r=1;r<=5;r++){let d=document.querySelector(`[activity-data='star-${r}']`);r<=$?(console.log($),d.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg")):d.setAttribute("src","https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg")}U(c,_,i),document.querySelector("[wized=activity_info_modal]").style.display="block"}window.onload=async()=>{mapboxgl.accessToken="pk.eyJ1Ijoiam9yZGFub25hcnJpdmFsIiwiYSI6ImNsbHY4bW0zaTFxZ3czZ256bjlqODZmNncifQ.1xHX4Xvmvz9KNYmrZdFybA",document.querySelector("[wized=activity_info_modal]").style.display="none",console.log("Window loaded"),Wized.request.awaitAllPageLoad(async()=>{Wized.request.await("Load Trip Page");let c=await Wized.data.get("r.18.d"),u={...c},i=new URLSearchParams(window.location.search),_=i.get("destination_id"),S=i.get("activity_id"),o=document.querySelector('[wized="destination_nav"]');console.log("dataStore:",c),c._guide_of_trips.forEach(e=>{e._guide_recommendations=e._guide_recommendations.filter(t=>{let s=t._place;return s&&s.google_lat!==0&&s.google_lng!==0});let a=document.createElement("a");a.setAttribute("wized","destination_nav_id"),a.setAttribute("href","#"),a.setAttribute("data-destination-id",e.id),a.classList.add("mab_tabs-wrapper","w-inline-block"),console.log(`Starting loop for guide ID: ${e.id}`);let l=document.createElement("p");l.setAttribute("wized","destination_nav_name"),l.setAttribute("data-destination-id",e.id),l.textContent=e._destination[0].short_name,l.classList.add("map_tabs-link"),a.appendChild(l),console.log(`Created anchor element with destination ID: ${e.id}`),o.appendChild(a),U(S,_,u),a.addEventListener("click",function(){console.log(`Clicked on destination ID: ${e.id}, Place: ${e.place}`),i.delete("activity_id"),history.replaceState({},"",`${location.pathname}?${i}`),console.log("Replaced State");let t=r.filter(s=>s.destinationId===e.id);console.log(t,e.id),console.log("New active coordsss",t),console.log("Current coordinates array:",JSON.stringify(r)),h(t,y)})}),_&&(document.querySelectorAll("[data-destination-id]").forEach(e=>{e.classList.remove("is-active"),e.getAttribute("data-destination-id")===_&&(console.log("tried adding class"),e.classList.add("is-active"))}),document.querySelectorAll("[data-destination-id]").forEach(e=>{e.addEventListener("click",function(a){document.querySelectorAll("[data-destination-id]").forEach(t=>t.classList.remove("is-active")),a.currentTarget.classList.add("is-active");let l=document.querySelector("[wized='activity_info_modal']");l&&(l.style.display="none")})}));let b=document.querySelectorAll('[wized="destination_nav"]');b.forEach(e=>{console.log(b),e.getAttribute("data-destination-id")===_?e.classList.add("is-active"):e.classList.remove("is-active")});let k=i.get("destination_id");S&&F(S,c,u,k);let q=[0,0];if(_){for(let e of c._guide_of_trips)if(e.id.toString()===_){let a=e._destination&&e._destination[0];q=[a.mobi_lng,a.mobi_lat];break}}else{let e=c._guide_of_trips[0],a=e._destination&&e._destination[0];q=[a.mobi_lng,a.mobi_lat]}let y=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:q,zoom:17}),f=null;function v(e){console.log("Fly to place",e);let l=10*16;y.flyTo({center:[e.google_lng,e.google_lat],zoom:15,offset:[l,0]});let t=document.querySelector(`[marker_activity_id="${e.id}"]`),s=e._place_category.category_icon_active.url;t&&(t.style.border="2px solid #636BFF",t.style.backgroundImage=`url("${s}")`,f=t)}document.querySelectorAll("[data-destination-id]").forEach(e=>{e.addEventListener("click",function(){document.querySelectorAll("[data-destination-id]").forEach(t=>{t.classList.remove("is-active")}),this.classList.add("is-active");let a=this.getAttribute("data-destination-id");console.log(`Destination ID clicked: ${a}`);let l=c._guide_of_trips.find(t=>t.id.toString()===a);if(console.log(c._guide_of_trips),console.log(a),l&&l._destination&&l._destination[0]){let s=l._guide_recommendations.map(n=>[n._place.google_lng,n._place.google_lat]);h(s,y);let w=new URLSearchParams(window.location.search);w.set("destination_id",a),w.delete("activity_id"),history.replaceState({},"",`${location.pathname}?${w}`),console.log("Replaced State")}})});function C(e,a){let[l,t]=e,[s,w]=a;return Math.sqrt(Math.pow(s-l,2)+Math.pow(w-t,2))}y.on("moveend",()=>{let e=y.getCenter().toArray();console.log("Map moved, center is: ",e);let a=null,l=1/0;if(c._guide_of_trips.forEach(t=>{let s=t;if(s.id){let w=[s._destination[0].mobi_lng,s._destination[0].mobi_lat];console.log(w);let n=C(e,w);console.log("Calculated distance: ",n),n<l&&(l=n,a={id:s.id,mobi_lat:s._destination[0].mobi_lat,mobi_lng:s._destination[0].mobi_lng},console.log("Updated closest destination: ",a))}}),a){console.log("Closest destination is: ",a),document.querySelectorAll("[data-destination-id]").forEach(s=>{console.log("Removing is-active class from: ",s),s.classList.remove("is-active")});let t=document.querySelector(`[data-destination-id="${a.id}"]`);t?(console.log("Adding is-active class to: ",t),t.classList.add("is-active")):console.log(`No element found for destination_id: ${a}`)}else console.log("No closest destination found")});function E(){return window.innerWidth<=1024}y.addControl(new mapboxgl.NavigationControl);function $(e,a,l){let t=e._place;if(console.log("Marker added at:",t.google_lng,t.google_lat),!t)return null;let s=t._place_category.category_icon.url,w=t._place_category.category_icon_active.url,n=document.createElement("div");n.style.backgroundImage=`url("${s}")`,n.setAttribute("original-image-url",s),n.setAttribute("active-image-url",w),n.setAttribute("marker_activity_id",e.place_id),n.style.backgroundRepeat="no-repeat",n.style.backgroundPosition="center",n.style.backgroundSize="18px 18px",n.style.width="41px",n.style.height="25px",n.style.borderRadius="12.5px",n.style.backgroundColor="var(--primary-white, #FFF)",n.style.boxShadow="0px 4px 4px 0px rgba(35, 16, 94, 0.10)",n.style.border="2px solid grey";let p=new mapboxgl.Marker(n).setLngLat([t.google_lng,t.google_lat]).addTo(a),M=`
        <div class="mini-card_component is-popup" style="z-index: 100 !important;">
        <img src="${t.oa_place_image.url}" alt="" class="mini-card_image">
        <div class="mini-card_content">
        <div class="margin-bottom margin-xxsmall">
        <div class="text-weight-bold">${t.google_name}</div>
        </div>
        <div class="margin-bottom margin-xsmall">
        <div class="mini-card_tag-wrapper">
        <img src="${t._place_category.category_icon.url}" loading="lazy" alt="" class="mini-card_tag-icon">
        <div class="text-size-small text-color-grey">${t._place_category.category_name||"No description available."}</div>
        </div>
        </div>
        <div class="rating-stars_component">
        <img id="popup-star-1" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-2" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-3" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-4" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        <img id="popup-star-5" src="https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg" loading="lazy" alt="">
        </div>
        </div>
        <img loading="lazy" alt="" class="popup-card_arrow">
        </div>
        `,D=new mapboxgl.Popup({offset:25,closeButton:!1}).setHTML(M);D.on("open",()=>{let x=Math.floor(t.google_rating);for(let m=1;m<=5;m++){let I=D._content.querySelector(`#popup-star-${m}`);I&&(I.src=m<=x?"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cbcc2d93ee2563a85e_star-blue.svg":"https://uploads-ssl.webflow.com/642d2be9a355e8eae598cfe4/643532cba4222a070cca9211_star-grey.svg")}}),a.on("click",()=>{document.querySelector("[wized=activity_info_modal]").style.display="none",l=null,g=null,i.delete("activity_id");let x=new URL(window.location.href);x.search=i.toString(),history.replaceState(null,null,x.toString()),console.log("Replaced State"),L()});function R(x){x.stopPropagation();let m=P(e.place_id,c);i.set("activity_id",e.place_id),i.set("destination_id",m),history.pushState({},"",`${location.pathname}?${i}`),l=e.id,g=e.place_id,L(),z=!1;let I=i.get("destination_id");F(e.place_id,c,u,I),v(t)}if(E())n.addEventListener("touchend",R);else{n.addEventListener("mouseenter",()=>{let m=i.get("activity_id");if(n.style.cursor="pointer",n.getAttribute("marker_activity_id")===m)n.style.zIndex="0";else{let A=document.querySelector(`[marker_activity_id="${m}"]`);A&&(A.style.zIndex="0"),n.style.zIndex="0"}D.setLngLat(p.getLngLat()).addTo(a)});let x=i.get("activity_id");n.addEventListener("mouseleave",()=>{let m=i.get("activity_id");n.style.cursor="default";let I=document.querySelector(`[marker_activity_id="${m}"]`);I&&(I.style.zIndex="1");let A=n.getAttribute("marker_activity_id");A===m?n.style.zIndex="1":(console.log("0",A,m),n.style.zIndex="0"),D.remove()}),n.addEventListener("click",m=>{m.stopPropagation();let I=P(e.place_id,c);i.set("activity_id",e.place_id),i.set("destination_id",I),history.pushState({},"",`${location.pathname}?${i}`),l=e.id,g=e.place_id,L(),z=!1;let A=i.get("destination_id");F(e.place_id,c,u,A),v(t)})}return document.querySelectorAll("[wized='activity_close_button']").forEach((x,m)=>{x.getAttribute("data-listener")!=="true"&&(x.addEventListener("click",function(I){if(console.log(`Clicked button index: ${m}`),console.log("Current closeFlag state:",z),z)console.log("Skipped due to closeFlag being true");else{console.log("Inside closeFlag check"),document.querySelector("[wized=activity_info_modal]").style.display="none",console.log("Modal closed"),i.delete("activity_id"),console.log("Deleted activity_id");let A=new URL(window.location.href);A.search=i.toString(),history.replaceState(null,null,A.toString()),console.log("Replaced State"),z=!0,console.log("Updated closeFlag state:",z),L()}}),x.setAttribute("data-listener","true"))}),n}let r=[],d=[];var g=null;y.on("load",function(){console.log("Map loaded");let e=new URLSearchParams(window.location.search),a=e.get("destination_id"),l=e.get("activity_id"),t=!1;c._guide_of_trips.forEach(s=>{console.log(`Processing guide ID: ${s.id}`),(s._guide_recommendations||[]).forEach(n=>{let p=n._place;if(!p)return;if(p.google_lng===0||p.google_lat===0){console.log(`Skipping place with invalid coordinates: [${p.google_lng}, ${p.google_lat}]`);return}console.log(`Adding coordinates: [${p.google_lng}, ${p.google_lat}]`),r.push([p.google_lng,p.google_lat]),console.log("Current coordinates array:",JSON.stringify(r)),s.id.toString()===a&&d.push([p.google_lng,p.google_lat]);let M=$(n,y,f);M&&(f=M,N[p.id]=M),console.log("This is place",p),String(p.id)===l&&(t=!0,v(p))})}),L(),window.addEventListener("popstate",L),console.log(`Generated ${r.length} coordinates`),console.log("Coordinates:",r),l&&!t&&console.log(`No activity found for ID: ${l}`),a&&!t?(console.log(`Setting map bounds for destination_id: ${a}`),h(d,y)):t||console.log("No destination_id or activity_id found. Using default map settings.")});function h(e,a){if(!e.length)return;let l=e.reduce((t,s)=>t.extend(s),new mapboxgl.LngLatBounds(e[0],e[0]));a.fitBounds(l,{padding:60})}})};})();
